{% extends 'base.html' %}
{% load summoner_filter %}
{% load static %}

{% block title %}
{% if user.summoner_name %}
 소환사 : {{ user.summoner_name }}
{% else %}
 소환사 정보 없음
{% endif %} 
{% endblock title %}

{% block css_link %}
<!-- Link Swiper's CSS -->
<link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css"/>

<link rel="stylesheet" href="{% static 'css/main.css' %}">
<link rel="stylesheet" href="{% static 'css/summoner.css' %}">
<link rel="stylesheet" href="{% static 'css/card.css' %}">
<link rel="stylesheet" href="{% static 'css/detail.css' %}">
{% endblock css_link %}


{%block content%}
<div class="container-fluid">

    <!-- search box -->
    <div class="serach-box">
        {% if user.summoner_name %}
        <button type="button" class="renewBtn btn btn-primary">
            <span class ="renewText">프로필 갱신</span>
            <div class="spinner-border" style="display: none;" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
        </button>
        {% endif %}
        <form class="search-form" action = "{% url 'summoner:search' %}" method="get" autocomplete="off">
            <div class="input-group input-group-sm mb-3 summoner-search-box">
                <span class="input-group-text" id="inputGroup-sizing-default">소환사명</span>
                <input type="text" required="required" name="userName" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm" autocomplete="off">
                <button type="submit" class="btn btn-outline-secondary btn-sm">
                    <img src="{% static 'images/search-icon.png' %}" class="search-icon">
                </button>
            </div>
        </form>
    </div>
    <!-- search box end -->

{% if user.summoner_name %} <!-- 소환사 정보가 존재하면 -->

    <!--소환사 정보 Start-->

    <!-- 레벨 및 아이콘-->
    <div class="summoner-info mt-4">
        <p class="text-center">
            <span class="summonerName fs-1">{{ user.summoner_name }}</span>
        </p>
        <div class="icon-frame mt-3 text-center">
            <!--summoner icon-->
            <img class="summonerIcon rounded-circle" src="http://ddragon.leagueoflegends.com/cdn/12.2.1/img/profileicon/{{user.summoner_icon}}.png">
        </div>
        
        <p class="summonerLevel bg-dark rounded-pill text-center py-1" style="color: white;">{{user.summoner_level}}</p>
    </div>

    <!-- solo-rank info / free-rank info -->
    <!--solo rank-->
    <div class="rank-info my-5">
        <div class="rank-wrap">
            <div class="rank-box solo-rank">
                {% if user.solo_tier|length > 0 %} <!--if summoner is ranked-->
                <p class="text-center my-2 fs-5">솔로랭크</p>
                <p class="text-center my-2 fs-3 tier-name">
                    <span class="soloRank">{{ user.solo_tier }}</span>
                    <span class="soloTier"> {{ user.solo_rank }}</span><br>
                    <span class="soloPoint" style ="font-size: 15px;"> {{user.solo_leaguePoints}} LP</span><br>
                    <span class="soloProgress" style ="font-size: 20px;">{{user.solo_progress|cur_progress}}</span>
                </p>
                <!--image-->
                <div class="tierImgDiv my-2 text-center">
                    <img class="tierImg soloImg" src="" alt="">
                </div>
                <div class="WinLose">
                    <span class="soloWin">{{ user.solo_wins }}승</span>
                    <span class="soloLose">{{ user.solo_losses}}패</span>
                    <span class="soloWinRatio">/ </span>
                </div>
                {% else %} <!--if summoner is unranked-->
                <p class="text-center my-2 fs-5">솔로랭크</p>
                <p class="text-center my-3 fs-3 tier-name">
                    <span>Unranked</span>
                </p>
                <div class="tierImgDiv text-center">
                    <img class="tierImg soloImg" src="{% static 'images/ranked-emblems/Unranked.png' %}" alt="unranked">
                </div>
                
                {% endif %}
            </div>
            <!--free rank-->
            <div class="rank-box free-rank">
                {% if user.free_tier|length > 0 %} <!-- if summoner is ranked -->
                <p class="text-center my-2 fs-5">자유 5:5 랭크</p>
                <p class="text-center my-2 fs-3 tier-name">
                    <span class="freeRank">{{ user.free_tier }}</span>
                    <span class="freeTier"> {{ user.free_rank }}</span><br>
                    <span class="freePoint" style="font-size: 15px;"> {{user.free_leaguePoints}} LP</span>
                    <span class="freeProgress" style ="font-size: 20px;">{{user.free_progress|cur_progress}}</span>
                </p>
                <!--image-->
                <div class="tierImgDiv my-2 text-center">
                    <img class="tierImg freeImg" src="" alt="">
                </div>
                <div class="WinLose">
                    <span class="freeWin">{{ user.free_wins }}승</span>
                    <span class="freeLose">{{ user.free_losses}}패</span>
                    <span class="freeWinRatio">/ </span>
                </div>
                {% else %} <!--if summoner is unranked-->
                <p class="text-center my-2 fs-5">자유 5:5 랭크</p>
                <p class="text-center my-3 fs-3 tier-name">
                    <span>Unranked</span>
                </p>
                <div class="tierImgDiv text-center">
                    <img class="tierImg freeImg" src="{% static 'images/ranked-emblems/Unranked.png' %}" alt="unranked">
                </div>

                {% endif %}
            </div>
        </div>
    </div>
    <!-- rank-info end -->

    <!-- game record card start -->
    <div class="record">

        <section class="record-section">

            <div class="record-container swiper mySwiper">
                <div class="record-content swiper-wrapper">
                    
                    {% for r in record %}
                    <div class="card swiper-slide" data-match-id={{r.match_ID}} data-result={{r.game_result}}>
                        <div class="card-content">
                            <div class="champion-img">
                                <img src="https://ddragon.leagueoflegends.com/cdn/12.2.1/img/champion/{{r.champ_name}}.png" alt="Talon">
                            </div>
                            <div class="champion-name">
                                <span class="name">{{r.champ_name|eng_to_kor}}</span>
                            </div>
                            <div class="date-type tooltip-div" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-container="body" title="{{r.game_end|unix_to_full_date}}">
                                <span class="date">{{r.game_end|unix_to_date}}</span>
                                <span class="type">{{r.queue_ID|det_game_type}}</span>
                            </div>
                            <div class="result-time">
                                <span class="result">{{r.game_result|det_win_lose}}</span><br>
                                <span class="time">{{r.game_duration|sec_to_min}}분</span>
                            </div>
                            <div class="game-kda">
                                <span class="kill">{{r.kill}}</span>/<!--
                             --><span class="death">{{r.death}}</span>/<!--
                             --><span class="assist">{{r.assist}}</span>
                            </div>
                        </div>
                    </div>
                    {% endfor %}


                    {% comment %} 카드 형식 예시:

                    <div class="card card-win swiper-slide">
                        <div class="card-content">
                            <div class="champion-img">
                                <img src="https://ddragon.leagueoflegends.com/cdn/12.2.1/img/champion/Talon.png" alt="Talon">
                            </div>
                            <div class="champion-name">
                                <span class="name">탈론</span>
                            </div>
                            <div class="date-type">
                                <span class="date">1/30</span>
                                <span class="type">솔로랭크</span>
                            </div>
                            <div class="result-time">
                                <span class="result">승리</span><br>
                                <span class="time">32분</span>
                            </div>
                            <div class="game-kda">
                                <sapn class="kda">8/0/3</sapn>
                            </div>
                        </div>
                    </div>

                    {% endcomment %}
                </div>
                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
                <div class="swiper-pagination"></div>
            </div>

    </section>
    </div>
    <!-- game record end-->

    <!-- detail record start-->
    <div class="detail-container mb-3">
        <div class="detail-record">
            <div class="team-container my-3">
                <div class="red-team team-info">
                    <div class="team-name fs-1 mx-auto">레드팀</div>
                    <div class="game-result fs-1 mx-auto my-3" style="color: royalblue;">WIN</div>
                    
                    <div class="detail-table-wrap">
                        <table class="table detail-table">
                            <thead>
                                <tr>
                                    <th class="text-center" scope="col" style="width:110px;">챔피언</th>
                                    <th class="text-center" scope="col" style="width:7%;">소환사</th>
                                    <th class="text-center" scope="col">Score</th>
                                    <th class="text-center" scope="col">KDA</th>
                                    <th class="text-center" scope="col">딜량</th>
                                    <th class="text-center" scope="col">시야점수</th>
                                    <th class="text-center" scope="col">CS</th>
                                    <th class="text-center" scope="col">아이템</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- one row start -->
                                <tr class="row-sample" style="display: none;">
                                    <td class="champ-info">
                                        <div class="img-level d-inline">
                                            <img class="champ rounded-circle" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/champion/Gragas.png">
                                            <div class="level rounded-circle">
                                                10
                                            </div>
                                        </div>
                                        <div class="d-inline-flex justify-content-between align-top">
                                            <div class="d-flex flex-column spell-box">
                                                <img class="spell rounded" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/spell/SummonerTeleport.png">
                                                <img class="spell rounded" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/spell/SummonerFlash.png">
                                            </div>
                                            <div class="d-flex flex-column m1-1 rune-box">
                                                <img class="rune rounded" src="https://ddragon.leagueoflegends.com/cdn/img/perk-images/Styles/Resolve/GraspOfTheUndying/GraspOfTheUndying.png">
                                                <img class="rune rounded" src="https://ddragon.leagueoflegends.com/cdn/img/perk-images/Styles/7202_Sorcery.png">
                                            </div>
                                            
                                        </div>
                                    </td>
                                    <td class="summoner-name align-top text-center">
                                        <a class="name" href="./?userName=rqew" target="_blank">rqew</span>
                                    </td>
                                    <td class="score align-top">
                                        <div class="d-flex flex-column justify-content-between">
                                            <p class="score-text text-center">7.0</span>
                                            <p class="score-rank text-center mt-2">1등</span>
                                        </div>
                                    </td>
                                    <td class="KDA align-top">
                                        <div class="d-flex flex-column justify-content-between">
                                            <p class="kda-num text-center kdaOver3">3.50:1</p>
                                            <div class="kda-detail mt-2 text-center">
                                                <span class="kda">3/0/1</span>
                                                <span class="kill-part">(50%)</span>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="damgae align-top">
                                        <div class="d-flex flex-column justify-content-between">
                                            <p class="damage-chart text-center">35,000</span>
                                            <p class="damage-rank text-center mt-2">3등</span>
                                        </div>
                                    </td>
                                    <td class="vision-score align-top">
                                        <div class="d-flex flex-column justify-content-between">
                                            <p class="score text-center">21</p>
                                            <p class="score-per-min mt-2 text-center">1.2 vision/분</p>
                                        </div>
                                    </td>
                                    <td class="CS align-top">
                                        <div class="d-flex flex-column justify-content-between">
                                            <p class="cs-num text-center">130</p>
                                            <p class="cs-per-min mt-2 text-center">7.2 cs/분</p>
                                        </div>
                                    </td>
                                    <td class="items align-top text-center">
                                         <div class="d-inline-flex flex-column" style="min-width: 66px">
                                            <div class="itemRow1 d-flex">
                                                <img class="item rounded m-item" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/item/3070.png">
                                                <img class="item rounded m-item" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/item/3071.png">
                                                <img class="item rounded m-item" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/item/3072.png">
                                            </div>
                                            <div class="itemRow2 d-flex">
                                                <img class="item rounded m-item" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/item/3068.png">
                                                <img class="item rounded m-item" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/item/3074.png">
                                                <img class="item rounded m-item" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/item/3075.png">
                                            </div>
                                        </div>   
                                    </td>
                                </tr>
                                <!-- one row end -->
                                
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
            <div class="team-container my-3">
                <div class="blue-team team-info">
                    <div class="team-name fs-1 mx-auto">블루팀</div>
                    <div class="game-result fs-1 mx-auto my-3" style="color: crimson;">LOSE</div>
                    
                    <div class="detail-table-wrap">
                        <table class="table detail-table">
                            <thead>
                                <tr>
                                    <th class="text-center" scope="col" style="width:110px;">챔피언</th>
                                    <th class="text-center" scope="col" style="width:7%;">소환사</th>
                                    <th class="text-center" scope="col">Score</th>
                                    <th class="text-center" scope="col">KDA</th>
                                    <th class="text-center" scope="col">딜량</th>
                                    <th class="text-center" scope="col">시야점수</th>
                                    <th class="text-center" scope="col">CS</th>
                                    <th class="text-center" scope="col">아이템</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- one row start -->
                                <tr>
                                    <td class="champ-info">
                                        <div class="img-level d-inline">
                                            <img class="champ rounded-circle" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/champion/Gragas.png">
                                            <div class="level rounded-circle">
                                                10
                                            </div>
                                        </div>
                                        <div class="d-inline-flex justify-content-between align-top">
                                            <div class="d-flex flex-column spell-box">
                                                <img class="spell rounded" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/spell/SummonerTeleport.png">
                                                <img class="spell rounded" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/spell/SummonerFlash.png">
                                            </div>
                                            <div class="d-flex flex-column m1-1 rune-box">
                                                <img class="rune rounded" src="https://ddragon.leagueoflegends.com/cdn/img/perk-images/Styles/Resolve/GraspOfTheUndying/GraspOfTheUndying.png">
                                                <img class="rune rounded" src="https://ddragon.leagueoflegends.com/cdn/img/perk-images/Styles/7202_Sorcery.png">
                                            </div>
                                            
                                        </div>
                                    </td>
                                    <td class="summoner-name align-top text-center">
                                        <a class="name" href="./?userName=rqew" target="_blank">rqew</span>
                                    </td>
                                    <td class="score align-top">
                                        <div class="d-flex flex-column justify-content-between">
                                            <p class="score-text text-center">7.0</span>
                                            <p class="score-rank text-center mt-2">1등</span>
                                        </div>
                                    </td>
                                    <td class="KDA align-top">
                                        <div class="d-flex flex-column justify-content-between">
                                            <p class="kda-num text-center kdaOver3">3.50:1</p>
                                            <div class="kda-detail mt-2 text-center">
                                                <span class="kda">3/0/1</span>
                                                <span class="kill-part">(50%)</span>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="damgae align-top">
                                        <div class="d-flex flex-column justify-content-between">
                                            <p class="damage-chart text-center">35,000</span>
                                            <p class="damage-rank text-center mt-2">3등</span>
                                        </div>
                                    </td>
                                    <td class="vision-score align-top">
                                        <div class="d-flex flex-column justify-content-between">
                                            <p class="score text-center">21</p>
                                            <p class="score-per-min mt-2 text-center">1.2 vision/분</p>
                                        </div>
                                    </td>
                                    <td class="CS align-top">
                                        <div class="d-flex flex-column justify-content-between">
                                            <p class="cs-num text-center">130</p>
                                            <p class="cs-per-min mt-2 text-center">7.2 cs/분</p>
                                        </div>
                                    </td>
                                    <td class="items align-top text-center">
                                         <div class="d-inline-flex flex-column" style="min-width: 66px">
                                            <div class="itemRow1 d-flex">
                                                <img class="item rounded m-item" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/item/3070.png">
                                                <img class="item rounded m-item" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/item/3071.png">
                                                <img class="item rounded m-item" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/item/3072.png">
                                            </div>
                                            <div class="itemRow2 d-flex">
                                                <img class="item rounded m-item" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/item/3068.png">
                                                <img class="item rounded m-item" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/item/3074.png">
                                                <img class="item rounded m-item" src="https://ddragon.leagueoflegends.com/cdn/12.3.1/img/item/3075.png">
                                            </div>
                                        </div>   
                                    </td>
                                </tr>
                                <!-- one row end -->
                                
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <!-- detail record end-->

    <!--소환사 정보 End-->

{% else %} <!--소환사 이름이 존재 X(Error)-->
    <!--Error Start-->
    <div class="error-box alert alert-danger align-text-top" role="alert">
        <h1>소환사 '{{ userName }}'에 대한 정보가 존재하지 않습니다!</h1>
    </div>
    <div class="error-img">
        <img class="rounded mx-auto d-block" src="{% static 'images/not_found.png' %}" alt="not_found">
    </div>

    <div class="empty"></div>
    
    <!--Error End-->
{% endif %}
</div>
{%endblock%}

{% block script %}
<!-- Swiper JS -->
<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

<!-- Initialize Swiper -->
<script>
    var swiper = new Swiper(".mySwiper", {
        slidesPerView: 4,
        spaceBetween: 30,
        slidesPerGroup: 4,
        loop: true,
        loopFillGroupWithBlank: true,
        pagination: {
        el: ".swiper-pagination",
        clickable: true,
        },
        navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
        },
    });
    </script>

<script type="text/javascript">
    DJANGO_STATIC_URL = '{{STATIC_URL}}';
</script>
<script type="text/javascript" src="{% static 'js/summoner.js' %}"></script>
<script type="text/javascript" src="{% static 'js/renew.js' %}"></script>
<script type="text/javascript" src="{% static 'js/record.js' %}"></script>
{% endblock script %}